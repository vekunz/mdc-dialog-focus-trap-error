# mdc-dialog focus trap error

This repository demonstrates a FocusTrap Error of mdc-dialog, if used in a unit test.

To reproduce the error, follow these steps:

```bash
# Install dependencies
npm install

# Run tests
npm run test
```

## Tech Stack

`@material/dialog` is used in a `svelte` component. The tests are executed with `vitest` as test runner and `@testing-library/svelte` for rendering svelte components.

## Structure of the repository

These are the important files of this repository.

| name                     | description                                                     |
|--------------------------|-----------------------------------------------------------------|
| vitest.config.js         | Contains the configuration for `vitest`                         |
| src/TestComponent.svelte | A helper component to use slot-content inside tests             |
| src/Dialog.svelte        | The svelte component that acts as a wrapper around mdc-dialog   |
| src/Dialog.test.js       | The unit tests that should test the behavior of `Dialog.svelte` |


## Detailed error description

The test produces this error message.

```
Serialized Error: {
  "errors": [
    [Error: FocusTrap: Element must have at least one focusable child.],
  ],
}
```

Normally this error only occurs, if the mdc-dialog does not contain a focusable element. But in this case the dialog does indeed contain a focusable element.

This is the HTML that is generated by the `render()` function in the test.

```html
<div class="mdc-dialog" data-testid="dialog">
  <div class="mdc-dialog__container">
    <div aria-modal="true" class="mdc-dialog__surface" role="alertdialog">
      <div class="mdc-dialog__actions">
        <button class="mdc-button mdc-dialog__button">
          <span class="mdc-button__label">Button text</span>
        </button>
      </div>
    </div>
  </div>
  <div class="mdc-dialog__scrim"/>
</div>
```
